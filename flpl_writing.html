<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>2ë‹¨ê³„ Power Voca</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f2f2f2;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px;
    }
    h2 {
      margin-bottom: 5px;
    }
    h3 {
      margin-top: 0;
      color: #333;
    }
    input[type="text"] {
      font-size: 1.5em;
      padding: 5px;
      margin: 5px;
      text-align: center;
      width: 150px;
    }
    .spell-inputs input {
      width: 60px;
      text-transform: lowercase;
    }
    button {
      padding: 10px 20px;
      font-size: 1em;
      margin: 10px;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<h2>Power Voca: ë“£ê³  ì“°ê¸° í•™ìŠµ</h2>
<h3 id="problemNumber">1ë²ˆ ë¬¸ì œ</h3>

<div id="stage1">
  <p><b>1ë‹¨ê³„:</b> ë“£ê³  ë‹¨ì–´ ì“°ê¸°</p>
  <button onclick="playWord()">ğŸ”Š ë“£ê¸°</button><br>
  <input type="text" id="input1" onpaste="return false;" placeholder="ë‹¨ì–´ ì…ë ¥" autocomplete="off" /><br>
  <button onclick="checkAnswer()">í™•ì¸</button>
  <div id="message1"></div>
</div>

<div id="stage2" class="hidden">
  <p><b>2ë‹¨ê³„:</b> ì² ì ë°˜ë³µ ì…ë ¥</p>
  <div class="spell-inputs" id="repeatInputs"></div>
  <button onclick="checkRepeat()">ë‹¤ìŒ ë‹¨ì–´ë¡œ</button>
  <div id="message2"></div>
</div>

<div id="complete" class="hidden">
  <h2>ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! 10ê°œ ë‹¨ì–´ë¥¼ ëª¨ë‘ ì™„ì„±í–ˆìŠµë‹ˆë‹¤.</h2>
</div>

<script>
const words = ["flag", "flat", "flip", "flesh", "flush", "plum", "plan", "plug", "plot", "plate"];
let current = 0;
let attempt = 0;

function updateProblemNumber() {
  document.getElementById("problemNumber").innerText = (current + 1) + "ë²ˆ ë¬¸ì œ";
}

function playWord() {
  const utter = new SpeechSynthesisUtterance("     " + words[current]);
  utter.lang = "en-US";
  utter.rate = 0.75;
  speechSynthesis.speak(utter);
}

function checkAnswer() {
  const input = document.getElementById("input1");
  const msg = document.getElementById("message1");
  const answer = input.value.trim().toLowerCase();
  const correct = words[current];

  if (answer === correct) {
    msg.textContent = "ì •ë‹µì…ë‹ˆë‹¤! 2ë‹¨ê³„ë¡œ ì´ë™í•©ë‹ˆë‹¤.";
    showStage2(correct);
  } else {
    attempt++;
    if (attempt >= 3) {
      msg.textContent = "ì •ë‹µì€ " + correct + " ì…ë‹ˆë‹¤. 2ë‹¨ê³„ë¡œ ì´ë™í•©ë‹ˆë‹¤.";
      showStage2(correct);
    } else {
      msg.textContent = "í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”. (" + attempt + "/3)";
    }
  }
}

function showStage2(correct) {
  document.getElementById("stage1").classList.add("hidden");
  document.getElementById("stage2").classList.remove("hidden");
  const container = document.getElementById("repeatInputs");
  container.innerHTML = "";
  for (let i = 0; i < 10; i++) {
    const inp = document.createElement("input");
    inp.type = "text";
    inp.setAttribute("maxlength", correct.length);
    inp.setAttribute("onpaste", "return false;");
    inp.dataset.correct = correct;
    container.appendChild(inp);
  }
}

function checkRepeat() {
  const inputs = document.querySelectorAll("#repeatInputs input");
  let allCorrect = true;
  inputs.forEach(input => {
    if (input.value.trim().toLowerCase() !== input.dataset.correct) {
      allCorrect = false;
    }
  });
  if (allCorrect) {
    current++;
    if (current >= words.length) {
      document.getElementById("stage2").classList.add("hidden");
      document.getElementById("complete").classList.remove("hidden");
    } else {
      attempt = 0;
      document.getElementById("input1").value = "";
      document.getElementById("message1").textContent = "";
      document.getElementById("message2").textContent = "";
      document.getElementById("stage2").classList.add("hidden");
      document.getElementById("stage1").classList.remove("hidden");
      updateProblemNumber();
    }
  } else {
    document.getElementById("message2").textContent = "ì˜¤ë‹µì´ ìˆìŠµë‹ˆë‹¤. ëª¨ë‘ ë§ì•„ì•¼ ë‹¤ìŒ ë‹¨ì–´ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
  }
}

// ì²˜ìŒ ì‹œì‘í•  ë•Œ ë¬¸ì œ ë²ˆí˜¸ í‘œì‹œ
updateProblemNumber();
</script>

</body>
</html>
